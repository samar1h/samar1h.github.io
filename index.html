<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Samarth's Portfolio - Pharmacy student passionate about tech and learning">
    <title>Samarth - Portfolio</title>
    <style>
        /* Design System Variables */
        :root {
            /* Primitive Color Tokens */
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-teal-800: rgba(41, 150, 161, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);

            /* RGB versions for opacity control */
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 192, 21, 47;
            --color-red-400-rgb: 255, 84, 89;
            --color-orange-500-rgb: 168, 75, 47;
            --color-orange-400-rgb: 230, 129, 97;

            /* Background color tokens (Light Mode) */
            --color-bg-1: rgba(59, 130, 246, 0.08);
            --color-bg-2: rgba(245, 158, 11, 0.08);
            --color-bg-3: rgba(34, 197, 94, 0.08);
            --color-bg-4: rgba(239, 68, 68, 0.08);
            --color-bg-5: rgba(147, 51, 234, 0.08);
            --color-bg-6: rgba(249, 115, 22, 0.08);
            --color-bg-7: rgba(236, 72, 153, 0.08);
            --color-bg-8: rgba(6, 182, 212, 0.08);

            /* Semantic Color Tokens (Light Mode) */
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-btn-primary-text: var(--color-cream-50);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
            --color-error: var(--color-red-500);
            --color-success: var(--color-teal-500);
            --color-warning: var(--color-orange-500);
            --color-info: var(--color-slate-500);
            --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
            --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

            /* Typography */
            --font-family-base: "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            --line-height-tight: 1.2;
            --line-height-normal: 1.5;
            --letter-spacing-tight: -0.01em;

            /* Spacing */
            --space-0: 0;
            --space-1: 1px;
            --space-2: 2px;
            --space-4: 4px;
            --space-6: 6px;
            --space-8: 8px;
            --space-10: 10px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;

            /* Border Radius */
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            --radius-full: 9999px;

            /* Shadows */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);

            /* Animation */
            --duration-fast: 150ms;
            --duration-normal: 250ms;
            --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* Dark mode colors */
        [data-theme="dark"] {
            --color-gray-400-rgb: 119, 124, 124;
            --color-teal-300-rgb: 50, 184, 198;
            --color-gray-300-rgb: 167, 169, 169;
            --color-gray-200-rgb: 245, 245, 245;

            --color-bg-1: rgba(29, 78, 216, 0.15);
            --color-bg-2: rgba(180, 83, 9, 0.15);
            --color-bg-3: rgba(21, 128, 61, 0.15);
            --color-bg-4: rgba(185, 28, 28, 0.15);
            --color-bg-5: rgba(107, 33, 168, 0.15);
            --color-bg-6: rgba(194, 65, 12, 0.15);
            --color-bg-7: rgba(190, 24, 93, 0.15);
            --color-bg-8: rgba(8, 145, 178, 0.15);

            --color-background: var(--color-charcoal-700);
            --color-surface: var(--color-charcoal-800);
            --color-text: var(--color-gray-200);
            --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
            --color-primary: var(--color-teal-300);
            --color-primary-hover: var(--color-teal-400);
            --color-primary-active: var(--color-teal-800);
            --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
            --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
            --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
            --color-border: rgba(var(--color-gray-400-rgb), 0.3);
            --color-error: var(--color-red-400);
            --color-success: var(--color-teal-300);
            --color-warning: var(--color-orange-400);
            --color-info: var(--color-gray-300);
            --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
            --color-btn-primary-text: var(--color-slate-900);
            --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
            --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
            --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

            --color-success-rgb: var(--color-teal-300-rgb);
            --color-error-rgb: var(--color-red-400-rgb);
            --color-warning-rgb: var(--color-orange-400-rgb);
            --color-info-rgb: var(--color-gray-300-rgb);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-base);
            background: var(--color-background);
            color: var(--color-text);
            line-height: var(--line-height-normal);
            font-size: var(--font-size-base);
            transition: background var(--duration-normal) var(--ease-standard);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-32) var(--space-16);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-32);
            flex-wrap: wrap;
            gap: var(--space-16);
        }

        .header-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
        }

        .header-controls {
            display: flex;
            gap: var(--space-12);
            align-items: center;
        }

        .btn {
            padding: var(--space-8) var(--space-16);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            color: var(--color-text);
            cursor: pointer;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            transition: all var(--duration-fast) var(--ease-standard);
            display: inline-flex;
            align-items: center;
            gap: var(--space-6);
        }

        .btn:hover {
            background: var(--color-secondary-hover);
            border-color: var(--color-primary);
        }

        .btn:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
            border-color: var(--color-primary);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        /* Profile Section */
        .profile-section {
            display: flex;
            gap: var(--space-32);
            margin-bottom: var(--space-32);
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .profile-image {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            border: 3px solid var(--color-primary);
            object-fit: cover;
        }

        .profile-info {
            flex: 1;
            min-width: 300px;
        }

        .profile-name {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-8);
            letter-spacing: var(--letter-spacing-tight);
        }

        .profile-bio {
            font-size: var(--font-size-lg);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-16);
            line-height: 1.6;
        }

        .profile-about {
            margin-bottom: var(--space-24);
        }

        .profile-about li {
            margin-bottom: var(--space-8);
            list-style: none;
            padding-left: var(--space-24);
            position: relative;
        }

        .profile-about li:before {
            content: "";
            position: absolute;
            left: 0;
            top: 9px;
            width: 6px;
            height: 6px;
            background: var(--color-primary);
            border-radius: 50%;
        }

        /* Social Links */
        .social-links {
            display: flex;
            gap: var(--space-12);
            flex-wrap: wrap;
            margin-bottom: var(--space-24);
        }

        .social-link {
            padding: var(--space-6) var(--space-12);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            color: var(--color-text);
            text-decoration: none;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            transition: all var(--duration-fast) var(--ease-standard);
            display: inline-flex;
            align-items: center;
            gap: var(--space-6);
        }

        .social-link:hover {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
            border-color: var(--color-primary);
            transform: translateY(-2px);
        }

        /* Tech Stack */
        .tech-stack {
            margin-bottom: var(--space-32);
        }

        .section-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-16);
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }

        .tech-badges {
            display: flex;
            gap: var(--space-8);
            flex-wrap: wrap;
        }

        .tech-badge {
            padding: var(--space-6) var(--space-12);
            border-radius: var(--radius-base);
            background: var(--color-bg-1);
            border: 1px solid var(--color-card-border);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text);
        }

        .tech-badge:nth-child(2) { background: var(--color-bg-2); }
        .tech-badge:nth-child(3) { background: var(--color-bg-3); }
        .tech-badge:nth-child(4) { background: var(--color-bg-4); }
        .tech-badge:nth-child(5) { background: var(--color-bg-5); }
        .tech-badge:nth-child(6) { background: var(--color-bg-6); }
        .tech-badge:nth-child(7) { background: var(--color-bg-7); }
        .tech-badge:nth-child(8) { background: var(--color-bg-8); }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-16);
            margin-bottom: var(--space-32);
        }

        .card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            transition: all var(--duration-normal) var(--ease-standard);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--color-primary);
        }

        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-8);
            color: var(--color-primary);
            text-decoration: none;
            display: block;
        }

        .card-title:hover {
            text-decoration: underline;
        }

        .card-description {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-12);
            line-height: 1.5;
        }

        .card-meta {
            display: flex;
            gap: var(--space-16);
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
            flex-wrap: wrap;
        }

        .card-meta-item {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .language-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Stats Section */
        .stats-section {
            margin-top: var(--space-32);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: var(--space-16);
        }

        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-16);
            overflow: hidden;
        }

        .stat-card img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius-base);
        }

        /* Loading Spinner */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: var(--space-32);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--color-secondary);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Cache Info */
        .cache-info {
            font-size: var(--font-size-xs);
            color: var(--color-text-secondary);
            margin-left: var(--space-8);
        }

        .hidden {
            display: none;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-16);
            }

            .profile-section {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-info {
                min-width: 100%;
            }

            .profile-about li {
                text-align: left;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .social-links {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="header-title">Portfolio</h1>
            <div class="header-controls">
                <span class="cache-info" id="lastUpdated"></span>
                <button class="btn" id="refreshBtn" aria-label="Refresh data from GitHub">
                    <span>‚Üª</span> Refresh
                </button>
                <button class="btn" id="themeToggle" aria-label="Toggle dark mode">
                    <span id="themeIcon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Loading State -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
        </div>

        <!-- Profile Section -->
        <section class="profile-section hidden" id="profileSection">
            <img class="profile-image" id="profileImage" alt="Profile" loading="lazy">
            <div class="profile-info">
                <h2 class="profile-name" id="profileName">Hello, I'm Samarth üëã</h2>
                <p class="profile-bio" id="profileBio">Pharmacy student at Baddi University of Emerging Sciences &amp; Technology, Himachal Pradesh.</p>
                
                <ul class="profile-about">
                    <li>üéì Currently studying pharmacy</li>
                    <li>üå± Passionate about learning and growing in my field</li>
                    <li>üíª Interested in building projects to showcase my skills</li>
                </ul>

                <div class="social-links" id="socialLinks">
                    <a href="https://www.linkedin.com/in/samar1h" target="_blank" class="social-link" rel="noopener noreferrer">
                        <span>üíº</span> LinkedIn
                    </a>
                    <a href="https://github.com/samar1h" target="_blank" class="social-link" rel="noopener noreferrer">
                        <span>üêô</span> GitHub
                    </a>
                    <a href="https://medium.com/@samar1h" target="_blank" class="social-link" rel="noopener noreferrer">
                        <span>‚úçÔ∏è</span> Medium
                    </a>
                    <a href="https://instagram.com/_nsamarth" target="_blank" class="social-link" rel="noopener noreferrer">
                        <span>üì∏</span> Instagram
                    </a>
                </div>
            </div>
        </section>

        <!-- Tech Stack -->
        <section class="tech-stack hidden" id="techStack">
            <h2 class="section-title">üíª Tech Stack</h2>
            <div class="tech-badges">
                <span class="tech-badge">Dart</span>
                <span class="tech-badge">C++</span>
                <span class="tech-badge">C</span>
                <span class="tech-badge">JavaScript</span>
                <span class="tech-badge">HTML5</span>
                <span class="tech-badge">Lua</span>
                <span class="tech-badge">Kotlin</span>
                <span class="tech-badge">Python</span>
                <span class="tech-badge">Rust</span>
            </div>
        </section>

        <!-- Repositories -->
        <section class="hidden" id="reposSection">
            <h2 class="section-title">üì¶ My Projects</h2>
            <div class="cards-grid" id="reposGrid"></div>
        </section>

        <!-- Starred Repos -->
        <section class="hidden" id="starredSection">
            <h2 class="section-title">‚≠ê Starred Repositories</h2>
            <div class="cards-grid" id="starredGrid"></div>
        </section>

        <!-- GitHub Stats -->
        <section class="stats-section hidden" id="statsSection">
            <h2 class="section-title">üìä GitHub Stats</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <img src="https://github-readme-streak-stats.herokuapp.com/?user=samar1h&theme=dark&hide_border=true" alt="GitHub Streak Stats" loading="lazy">
                </div>
                <div class="stat-card">
                    <img src="https://github-readme-stats.vercel.app/api?username=samar1h&theme=dark&hide_border=true&show_icons=true&count_private=true" alt="GitHub Stats" loading="lazy">
                </div>
                <div class="stat-card">
                    <img src="https://github-readme-stats.vercel.app/api/top-langs/?username=samar1h&theme=dark&hide_border=true&include_all_commits=true&count_private=true&layout=compact" alt="Top Languages" loading="lazy">
                </div>
            </div>
        </section>
    </div>

    <script>
        /**
         * Portfolio Application with GitHub API Integration
         * 
         * Caching Strategy:
         * - Uses in-memory JavaScript objects to store API responses
         * - Cache persists during session (page lifetime)
         * - Refresh button forces fresh API calls
         * - Fallback to hardcoded content if API fails
         * 
         * Note: localStorage/sessionStorage disabled in sandboxed environment
         * All state management uses JavaScript variables
         */

        const USERNAME = 'samar1h';
        const API_BASE = 'https://api.github.com';
        
        // In-memory cache (persists during page session)
        let cache = {
            user: null,
            repos: null,
            starred: null,
            timestamp: null
        };

        // Language colors mapping
        const languageColors = {
            JavaScript: '#f1e05a',
            Python: '#3572A5',
            Dart: '#00B4AB',
            'C++': '#f34b7d',
            C: '#555555',
            Rust: '#dea584',
            Kotlin: '#A97BFF',
            HTML: '#e34c26',
            CSS: '#563d7c',
            Lua: '#000080'
        };

        // Theme management
        function initTheme() {
            const savedTheme = getCachedTheme();
            const theme = savedTheme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            setTheme(theme);
        }

        function getCachedTheme() {
            // Try to get from cache variable
            return window._cachedTheme || null;
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            window._cachedTheme = theme;
            const icon = document.getElementById('themeIcon');
            icon.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        }

        // API Functions
        async function fetchGitHubData(endpoint) {
            const response = await fetch(`${API_BASE}${endpoint}`);
            if (!response.ok) {
                throw new Error(`GitHub API error: ${response.status}`);
            }
            return response.json();
        }

        async function loadUserData() {
            try {
                const user = await fetchGitHubData(`/users/${USERNAME}`);
                cache.user = user;
                return user;
            } catch (error) {
                console.error('Error fetching user data:', error);
                return null;
            }
        }

        async function loadRepos() {
            try {
                const repos = await fetchGitHubData(`/users/${USERNAME}/repos?sort=updated&per_page=100`);
                cache.repos = repos.filter(repo => !repo.fork).slice(0, 12);
                return cache.repos;
            } catch (error) {
                console.error('Error fetching repos:', error);
                return [];
            }
        }

        async function loadStarred() {
            try {
                const starred = await fetchGitHubData(`/users/${USERNAME}/starred?per_page=12`);
                cache.starred = starred;
                return starred;
            } catch (error) {
                console.error('Error fetching starred repos:', error);
                return [];
            }
        }

        // Render Functions
        function renderProfile(user) {
            if (!user) return;

            const profileImage = document.getElementById('profileImage');
            const profileName = document.getElementById('profileName');
            const profileBio = document.getElementById('profileBio');

            profileImage.src = user.avatar_url;
            profileImage.alt = user.name || user.login;
            
            if (user.name) {
                profileName.textContent = `Hello, I'm ${user.name} üëã`;
            }
            
            if (user.bio) {
                profileBio.textContent = user.bio;
            }
        }

        function createRepoCard(repo, isStarred = false) {
            const card = document.createElement('div');
            card.className = 'card';

            const title = document.createElement('a');
            title.className = 'card-title';
            title.href = repo.html_url;
            title.target = '_blank';
            title.rel = 'noopener noreferrer';
            title.textContent = repo.name;

            const description = document.createElement('p');
            description.className = 'card-description';
            description.textContent = repo.description || 'No description available';

            const meta = document.createElement('div');
            meta.className = 'card-meta';

            if (repo.language) {
                const langItem = document.createElement('span');
                langItem.className = 'card-meta-item';
                const dot = document.createElement('span');
                dot.className = 'language-dot';
                dot.style.backgroundColor = languageColors[repo.language] || '#ccc';
                langItem.appendChild(dot);
                langItem.appendChild(document.createTextNode(repo.language));
                meta.appendChild(langItem);
            }

            if (repo.stargazers_count > 0) {
                const starsItem = document.createElement('span');
                starsItem.className = 'card-meta-item';
                starsItem.innerHTML = `‚≠ê ${repo.stargazers_count}`;
                meta.appendChild(starsItem);
            }

            if (repo.forks_count > 0) {
                const forksItem = document.createElement('span');
                forksItem.className = 'card-meta-item';
                forksItem.innerHTML = `üî± ${repo.forks_count}`;
                meta.appendChild(forksItem);
            }

            card.appendChild(title);
            card.appendChild(description);
            card.appendChild(meta);

            return card;
        }

        function renderRepos(repos) {
            const grid = document.getElementById('reposGrid');
            grid.innerHTML = '';

            if (!repos || repos.length === 0) {
                grid.innerHTML = '<div class="empty-state">No repositories found</div>';
                return;
            }

            repos.forEach(repo => {
                grid.appendChild(createRepoCard(repo));
            });
        }

        function renderStarred(starred) {
            const grid = document.getElementById('starredGrid');
            grid.innerHTML = '';

            if (!starred || starred.length === 0) {
                grid.innerHTML = '<div class="empty-state">No starred repositories</div>';
                return;
            }

            starred.forEach(repo => {
                grid.appendChild(createRepoCard(repo, true));
            });
        }

        function updateLastUpdated() {
            const lastUpdated = document.getElementById('lastUpdated');
            if (cache.timestamp) {
                const date = new Date(cache.timestamp);
                const timeStr = date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
                lastUpdated.textContent = `Updated: ${timeStr}`;
            } else {
                lastUpdated.textContent = '';
            }
        }

        function showSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove('hidden');
            }
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }

        // Main data loading function
        async function loadAllData(forceRefresh = false) {
            // Show loading if forcing refresh
            if (forceRefresh) {
                document.getElementById('loading').classList.remove('hidden');
            }

            try {
                // Load from cache first if available and not forcing refresh
                if (!forceRefresh && cache.user && cache.repos && cache.starred) {
                    renderProfile(cache.user);
                    renderRepos(cache.repos);
                    renderStarred(cache.starred);
                    showSection('profileSection');
                    showSection('techStack');
                    showSection('reposSection');
                    showSection('starredSection');
                    showSection('statsSection');
                    hideLoading();
                    updateLastUpdated();
                    return;
                }

                // Fetch fresh data
                const [user, repos, starred] = await Promise.all([
                    loadUserData(),
                    loadRepos(),
                    loadStarred()
                ]);

                cache.timestamp = Date.now();

                // Render all data
                renderProfile(user);
                renderRepos(repos);
                renderStarred(starred);

                // Show all sections
                showSection('profileSection');
                showSection('techStack');
                showSection('reposSection');
                showSection('starredSection');
                showSection('statsSection');
                
                updateLastUpdated();
            } catch (error) {
                console.error('Error loading data:', error);
                // Show default content even on error
                showSection('profileSection');
                showSection('techStack');
                showSection('statsSection');
            } finally {
                hideLoading();
            }
        }

        // Event Listeners
        document.getElementById('themeToggle').addEventListener('click', toggleTheme);
        document.getElementById('refreshBtn').addEventListener('click', () => {
            loadAllData(true);
        });

        // Initialize
        initTheme();
        loadAllData(false);
    </script>
</body>
</html>